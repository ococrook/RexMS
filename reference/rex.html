<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>residue-resolved HDX-MS data analysis using Rex — rex • RexMS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="residue-resolved HDX-MS data analysis using Rex — rex"><meta property="og:description" content="These functions are used to implement the ReX model from Crook et al 2024.
using HDX-MS data using RJ-MCMC for inference.
These functions are used to implement the ReX model from Crook et al 2024.
using HDX-MS data using RJ-MCMC for inference."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RexMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ReX.html">Introduction to RexMS</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>residue-resolved HDX-MS data analysis using Rex</h1>
    
    <div class="hidden name"><code>rex.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions are used to implement the ReX model from Crook et al 2024.
using HDX-MS data using RJ-MCMC for inference.</p>
<p>These functions are used to implement the ReX model from Crook et al 2024.
using HDX-MS data using RJ-MCMC for inference.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rex</span><span class="op">(</span></span>
<span>  <span class="va">HdxData</span>,</span>
<span>  numIter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">379</span>,</span>
<span>  numtimepoints <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  multivariate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  tCoef <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  density <span class="op">=</span> <span class="st">"Gaussian"</span>,</span>
<span>  R_lower <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  R_upper <span class="op">=</span> <span class="va">R</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">100</span><span class="op">/</span><span class="op">(</span><span class="va">R</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, sdlog <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>, shape1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape2 <span class="op">=</span> <span class="fl">5</span>, shape <span class="op">=</span> <span class="fl">1</span>, b_alpha <span class="op">=</span> <span class="fl">1</span>, b_beta <span class="op">=</span> <span class="fl">200</span>, dshape <span class="op">=</span> <span class="fl">1</span>, d_alpha <span class="op">=</span> <span class="fl">1</span>, d_beta <span class="op">=</span></span>
<span>    <span class="fl">1</span>, sigma_sd <span class="op">=</span> <span class="fl">0.5</span>, pishape1 <span class="op">=</span> <span class="fl">1</span>, pishape2 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">0.92</span>,</span>
<span>  init_param <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  numChains <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">resolver</span><span class="op">(</span></span>
<span>  <span class="va">res</span>,</span>
<span>  numIter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">379</span>,</span>
<span>  numtimepoints <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  multivariate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  tCoef <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  density <span class="op">=</span> <span class="st">"Gaussian"</span>,</span>
<span>  R_lower <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  R_upper <span class="op">=</span> <span class="va">R</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">100</span><span class="op">/</span><span class="op">(</span><span class="va">R</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, sdlog <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>, shape1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape2 <span class="op">=</span> <span class="fl">5</span>, shape <span class="op">=</span> <span class="fl">1</span>, b_alpha <span class="op">=</span> <span class="fl">1</span>, b_beta <span class="op">=</span> <span class="fl">200</span>, dshape <span class="op">=</span> <span class="fl">1</span>, d_alpha <span class="op">=</span> <span class="fl">1</span>, d_beta <span class="op">=</span></span>
<span>    <span class="fl">1</span>, sigma_sd <span class="op">=</span> <span class="fl">0.5</span>, pishape1 <span class="op">=</span> <span class="fl">1</span>, pishape2 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">0.92</span>,</span>
<span>  init_param <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>HdxData</dt>
<dd><p>An object of class DataFrame containing the HDX-MS data</p></dd>


<dt>numIter</dt>
<dd><p>The number of iterations for the MCMC. Default is 1000
but recommend at least 5000 in practice</p></dd>


<dt>R</dt>
<dd><p>The number of residues in the protein</p></dd>


<dt>numtimepoints</dt>
<dd><p>The number of timepoints in the HDX-MS experiment</p></dd>


<dt>multivariate</dt>
<dd><p>A logical indicating whether to use a multivariate
model. Default is FALSE.</p></dd>


<dt>timepoints</dt>
<dd><p>A numeric vector of timepoints in the HDX-MS experiment.
Default is c(0, 30, 300).</p></dd>


<dt>tCoef</dt>
<dd><p>A numeric value for the timpeoint standard deviation
coefficient. Default is 1. This
allows for the timepoint standard deviation to vary by a fixed factor.
1 indicates the same for
each timepoint.</p></dd>


<dt>density</dt>
<dd><p>A character string indicating the density function to use.
Default is "Gaussian" but
typically "laplace" is also used.</p></dd>


<dt>R_lower</dt>
<dd><p>A numeric value indicating the lower bound for the residue
number. Default is 1. This
may change if you want to subset the protien or avoid a his-tag.</p></dd>


<dt>R_upper</dt>
<dd><p>A numeric value indicating the upper bound for the residue
number. Default is R. This
may change if you want to subset the protien.</p></dd>


<dt>priors</dt>
<dd><p>A list of prior parameters for the model</p></dd>


<dt>phi</dt>
<dd><p>A numeric value indicating the maximum uptake possible.
Default is 0.92. Typically the
deuterium buffer concentration of the HDX-MS experiment.</p></dd>


<dt>init_param</dt>
<dd><p>A character string indicating the initial parameter to
use. Default is "d" but "b" is also possible. This is used to help find
good initial parameters by guessing the initial uptake and is used
in the <code>uptakeGuess</code> function. We do not recommend changing
this unless you are an expert.</p></dd>


<dt>numChains</dt>
<dd><p>A numeric value indicating the number of chains to run. Default
is 2. This is used to run the chains in parallel.</p></dd>


<dt>seed</dt>
<dd><p>An integer value indicating the random number generation seed.
Default is NULL. This is used to set the seed for reproducibility.</p></dd>


<dt>BPPARAM</dt>
<dd><p>A BiocParallelParam object indicating the parallel backend to use.
Default is BiocParallel::bpparam(). This is used to run the chains in parallel.</p></dd>


<dt>res</dt>
<dd><p>An object of class DataFrame containing the HDX-MS data</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>Rex</code> returns an object of class <code>RexParams</code> containing the results</p>


<p><code>Rex</code> returns an object of class <code>RexParams</code> containing the results</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The 'ReX' function generates the sample from the joint posterior distribution
(object or class 'Rexparams') based on annotated HDX-MS data (object of class
<a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a>). Both are then passed to the <code>RexProcess</code> function to generate
summary data for further analysis and visualisation</p>
<p>The 'ReX' function generates the sample from the joint posterior distribution
(object or class 'Rexparams') based on annotated HDX-MS data (object of class
<a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a>). Both are then passed to the <code>RexProcess</code> function to generate
summary data for further analysis and visualisation</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">RexMS</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"BRD4_apo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BRD4_apo</span> <span class="op">&lt;-</span> <span class="va">BRD4_apo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">End</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">numTimepoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BRD4_apo</span><span class="op">$</span><span class="va">Exposure</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Timepoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BRD4_apo</span><span class="op">$</span><span class="va">Exposure</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rex_example</span> <span class="op">&lt;-</span> <span class="fu">rex</span><span class="op">(</span>HdxData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">BRD4_apo</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                numIter <span class="op">=</span> <span class="fl">4</span>, <span class="co"># typically much larger</span></span></span>
<span class="r-in"><span>                R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">BRD4_apo</span><span class="op">$</span><span class="va">End</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                numtimepoints <span class="op">=</span> <span class="va">numTimepoints</span>,</span></span>
<span class="r-in"><span>                timepoints <span class="op">=</span> <span class="va">Timepoints</span>,</span></span>
<span class="r-in"><span>                seed <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>                numChains <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>                tCoef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                BPPARAM <span class="op">=</span> <span class="fu">SerialParam</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fold 1 ... Fold 2 ... Fold 3 ... Fold 4 ... Fold 5 ... </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Oliver Crook.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

